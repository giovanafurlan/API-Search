<!doctype html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title></title>
</head>

<style>
    * {
        max-width: 100%;
    }

    .d-flex {
        padding: 3vh 0 3vh 1vw;
    }

    .form-control {
        width: 50%;
    }

    table {
        table-layout: auto;

    }

    td {
        vertical-align: baseline;
        max-width: 10vw;
    }

    img {
        max-width: 10vw;
        display: inline;
    }

    .btn-close {
        width: 0.2vw;
        margin: 1vh 1vh 0 0;
    }
</style>

<body>
    <div class="d-flex">
        <input class="form-control me-2" id="searchTerm" type="search" placeholder="Digite aqui" aria-label="Search">
        <button type="button" class="btn-close" aria-label="Close" onClick="limpar()"></button>
        <!-- <button class="btn btn-outline-success" onClick="limpar()">Nova Busca</button> -->
        <button class="btn btn-outline-success" type="submit" onClick="consulta()">Buscar</button>
    </div>

    <div class="table-responsive">
        <table class="table align-middle" id="tableCustodio">
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <script>
        function limpar() {
            $("#tableCustodio tr").remove();
        }

        function consulta() {
            var tabela = document.getElementById("tableCustodio");

            var sea = document.getElementById("searchTerm");

            start(sea.value);
        }

        function start(consulta) {

            // if ("#tableCustodio" != "") {

            console.log("Início da requisição");

            var url =
                "https://serpapi.com/search.json?engine=google_play&q=" + consulta +
                "&gl=br&hl=pt-br&store=apps&api_key=6681352881f290db8ec410f05bc6b9567276022001ad7812884fbac446d342d9";

            var tabela = document.getElementById("tableCustodio");

            $.ajax({
                url: url,
                crossDomain: true,
                type: "GET",
                dataType: "json",
                success: function (data) {

                    for (var i = 0; i < data.organic_results.length; i++) {

                        var linhaData = data.organic_results[i];

                        if (i == 0) {
                            var linha = tabela.insertRow(0);
                        } else {
                            var linha = tabela.insertRow();
                        }

                        var l = 0;
                        var nome = linha.insertCell(l++);
                        nome.innerHTML = linhaData.title;

                        // var nome2 = linha.insertCell(l++);
                        // nome2.innerHTML = linhaData.items.title;
                    }

                    for (var j = 0; j < data.organic_results.items.length; j++) {

                        var linhaData2 = data.organic_results.items[j];

                        m = 0
                        var nome2 = linha.insertCell(m++);
                        nome2.innerHTML = linhaData2.title;

                        var link = linha.insertCell(m++);
                        link.innerHTML = linhaData2.link;

                        var desc = linha.insertCell(m++);
                        desc.innerHTML = linhaData2.description;
                    }
                }
            });
        }
    </script>

</body>

</html>